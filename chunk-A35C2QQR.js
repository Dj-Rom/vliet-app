import{a as D}from"./chunk-H26XXGBI.js";import{a as F}from"./chunk-LD5LC5PG.js";import{h as I}from"./chunk-R63XIQ3C.js";import{a as g,b as c,c as y,d as _,h as x,j as C,k as V,l as k,m as w,n as E,q as N,s as A}from"./chunk-KBOLL6IX.js";import"./chunk-AWDAIWPN.js";import{Ca as v,Ua as h,Va as f,Wa as S,Xa as i,Ya as r,Za as m,db as b,e as d,jb as a,lb as p,sa as n,ya as s}from"./chunk-XTGCJEIM.js";var L=(l,t)=>t.id;function W(l,t){if(l&1&&(i(0,"option"),a(1),r()),l&2){let e=t.$implicit;n(),p(" ",e.vehicle_number," ")}}function M(l,t){if(l&1&&(i(0,"option"),a(1),r()),l&2){let e=t.$implicit;n(),p(" ",e.vehicle_number," ")}}var O=class l{constructor(t,e,o,u){this.alertService=t;this.vehicleFleetService=e;this.fb=o;this.formBuilder=u;this.form=this.formBuilder.group({dataStart:["",[c.required]],dataFinish:["",[c.required]],truck:["",c.required],trailer:["",c.required],notes:[""]},{validators:this.finishAfterStartValidator})}vehicleFleetList={truck:[],trailer:[]};form;ngOnInit(){return d(this,null,function*(){(yield this.vehicleFleetService.loadVehicleFleet()).forEach(e=>{e.type==="truck"?this.vehicleFleetList.truck.push(e):this.vehicleFleetList.trailer.push(e)}),this.form.patchValue({truck:this.vehicleFleetList.truck[0]?.vehicle_number||"",trailer:this.vehicleFleetList.trailer[0]?.vehicle_number||""}),console.log("Vehicle list:",this.vehicleFleetList)})}finishAfterStartValidator(t){let e=t.get("dataStart")?.value,o=t.get("dataFinish")?.value;if(!e||!o)return null;let u=new Date(e);return new Date(o)<u?{finishBeforeStart:!0}:null}onSubmit(){this.form.valid?this.fb.addInfoForCurrentUser(this.form.value).then(()=>{this.alertService.show("success","Waybill saved successfully"),this.form.reset()}).catch(t=>{this.alertService.show("error","Error saving waybill:")}):(this.alertService.show("error",`Form invalid ${this.form.errors}`),this.form.markAllAsTouched())}get dataStart(){return this.form.get("dataStart")}get dataFinish(){return this.form.get("dataFinish")}get truck(){return this.form.get("truck")}get trailer(){return this.form.get("trailer")}static \u0275fac=function(e){return new(e||l)(s(F),s(D),s(I),s(N))};static \u0275cmp=v({type:l,selectors:[["app-waybill"]],decls:22,vars:1,consts:[[1,"formWaybill",3,"ngSubmit","formGroup"],["for","truck"],["name","truck","formControlName","truck"],["for","trailer"],["name","trailer","formControlName","trailer"],["formControlName","dataStart","type","datetime-local"],["formControlName","dataFinish","type","datetime-local"],["formControlName","notes","name","","id","","cols","30","rows","10","placeholder","Notes"],["type","submit",1,"btn"]],template:function(e,o){e&1&&(i(0,"form",0),b("ngSubmit",function(){return o.onSubmit()}),i(1,"h2"),a(2,"Waybill"),r(),i(3,"label",1),a(4,"Truck:"),r(),i(5,"select",2),h(6,W,2,1,"option",null,L),r(),i(8,"label",3),a(9,"Trailer:"),r(),i(10,"select",4),h(11,M,2,1,"option",null,L),r(),i(13,"label"),a(14," Start: "),m(15,"input",5),r(),i(16,"label"),a(17," Finish: "),m(18,"input",6),r(),m(19,"textarea",7),i(20,"button",8),a(21,"SAVE"),r()()),e&2&&(S("formGroup",o.form),n(6),f(o.vehicleFleetList.truck),n(5),f(o.vehicleFleetList.trailer))},dependencies:[A,x,w,E,g,k,y,_,C,V],styles:[".formWaybill[_ngcontent-%COMP%]{width:80vw;max-width:600px;height:70vh;background:#1c69af;border:2px solid white;padding:10px;border-radius:8px;margin:10px auto;display:flex;flex-direction:column;align-items:stretch;justify-content:center;color:#fff;font-size:18px}h2[_ngcontent-%COMP%]{text-align:center}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{margin-bottom:20px;margin-top:5px;width:100%;height:30px}textarea[_ngcontent-%COMP%]{margin-bottom:30px}"]})};export{O as Waybill};
